##  5. WebSocket

### 1οΈβƒ£ WebSocket, μ™ ν•„μ”ν•κ°€? (ν•µμ‹¬ κ°λ…)

**"ν•λ§λ””λ΅ "HTTPμ ν•κ³„λ¥Ό κ·Ήλ³µν•κΈ° μ„ν•΄ λ“±μ¥ν• μ§„μ •ν• μ–‘λ°©ν–¥ μ‹¤μ‹κ°„ ν†µμ‹  κΈ°μ "** 

- **HTTPμ ν•κ³„:** ν΄λΌμ΄μ–ΈνΈκ°€ μ”μ²­(Request)ν•΄μ•Όλ§ μ„λ²„κ°€ μ‘λ‹µ(Response)ν•  μ μλ” **λ‹¨λ°©ν–¥ κµ¬μ΅°**μ΄λ©°, λ§¤λ² μ—°κ²°κ³Ό ν•΄μ λ¥Ό λ°λ³µν•λ” **λΉ„μ—°κ²°μ„±(Stateless)** νΉμ§•μ„ 
  - **μ‹¤μ‹κ°„ μ†ν†µμ— λ§¤μ° λΉ„ν¨μ¨μ **

- **WebSocketμ ν•΄κ²°μ±…:**

  - **μ–‘λ°©ν–¥ ν†µμ‹  (Full-duplex):** μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ΅ μ›ν•  λ• μ–Έμ λ“  λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›λ” 'μ „ν™” ν†µν™”' λ°©μ‹μ…λ‹λ‹¤. μ„λ²„κ°€ λ¨Όμ € ν΄λΌμ΄μ–ΈνΈμ—κ² λ°μ΄ν„°λ¥Ό λ°€μ–΄μ£Όλ” Pushκ°€ κ°€λ¥ν•΄μ§‘λ‹λ‹¤.

  - **μ§€μ†μ μΈ μ—°κ²° (Persistent Connection):** ν•λ² μ—°κ²°λλ©΄ κ·Έ ν†µλ΅(TCP)λ¥Ό κ³„μ† μ μ§€ν•λ©° λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›μ•„, λ§¤λ² μ—°κ²°μ„ λ§Ίκ³  λλ” μ¤λ²„ν—¤λ“κ°€ μ—†μµλ‹λ‹¤.


---

### 2οΈβƒ£ Polling / Long-Polling / SSE / WebSocket λΉ„κµ


| ν•­λ© | Polling | SSE | WebSocket |
|------|----------|-----|-----------|
| λ°©ν–¥μ„± | λ‹¨λ°©ν–¥ | λ‹¨λ°©ν–¥ | **μ–‘λ°©ν–¥** |
| μ§€μ—° | λ†’μ | λ‚®μ | **λ§¤μ° λ‚®μ** |
| λ°μ΄ν„° | ν…μ¤νΈ | ν…μ¤νΈ | ν…μ¤νΈ/λ°”μ΄λ„λ¦¬ |
| μ—°κ²° μ μ§€ | X | μ„λ²„ μ μ§€ | **μ§€μ† μ—°κ²°** |
| μ‹¤μ‹κ°„μ„± | λ‚®μ | μ¤‘κ°„ | **λ†’μ** |

#### π“ Polling: "νΉμ‹ μƒ μ†μ‹ μλ‚μ”?" (μ£ΌκΈ°μ μΈ μ§λ¬Έ)
- **κ°λ…:** ν΄λΌμ΄μ–ΈνΈκ°€ μΌμ • μ£ΌκΈ°λ΅ μ„λ²„μ— "μƒ λ°μ΄ν„° μλ‚μ”?"λ¥Ό μ”μ²­
- **μ¥μ :** κµ¬ν„ κ°„λ‹¨, λ¨λ“  λΈλΌμ°μ €/μ„λ²„ νΈν™
- **λ‹¨μ :** λ¶ν•„μ”ν• μ”μ²­ κ³Όλ‹¤, μ„λ²„ λ¦¬μ†μ¤ λ‚­λΉ„, μ§€μ—° μ¦κ°€
- **μ‚¬μ© μ:** μ‹¤μ‹κ°„μ„± λ‚®μ€ μ•λ¦Ό, λ‹¨μ λ°μ΄ν„° κ°±μ‹ 

#### π“ Long-Polling: "μƒ μ†μ‹ μƒκΈ°λ©΄ λ°”λ΅ μ•λ ¤μ£Όμ„Έμ”." (λ€κΈ°ν•λ” μ§λ¬Έ)
- **κ°λ…:** μ„λ²„κ°€ μ‘λ‹µμ„ λ³΄λ¥ν•κ³ , λ°μ΄ν„°κ°€ μƒκΈ°λ©΄ μ¦‰μ‹ μ‘λ‹µ β†’ μ¦‰ pseudo push
- **μ¥μ :** Polling λ€λΉ„ μ§€μ—° κ°μ†
- **λ‹¨μ :** μ—°κ²° μ μ§€ μ¤λ²„ν—¤λ“, μ„λ²„ μ¤λ λ“ λ¦¬μ†μ¤ μ μ 
- **μ‚¬μ© μ:** κµ¬ν• ν™κ²½(HTTP/1.1)μ—μ„μ μ±„ν…/μ•λ¦Ό

#### π“ SSE (Server-Sent Events): "μ„λ²„κ°€ λ³΄λ‚΄μ£Όλ” μ†μ‹λ§ λ“¤μ„κ²μ”." (μ„λ²„μ μΌλ°©μ  λ°©μ†΅)
- **κ°λ…:** μ„λ²„μ—μ„ ν΄λΌμ΄μ–ΈνΈλ΅ λ‹¨λ°©ν–¥ λ°μ΄ν„° μ¤νΈλ¦Όμ„ μ „μ†΅ν•λ” HTML5 ν‘μ¤€ κΈ°μ 
- **νΉμ§•:** κµ¬ν„μ΄ κ°„λ‹¨ν•κ³ , HTTP κΈ°λ°μ΄λΌ κΈ°μ΅΄ μΈν”„λΌμ™€ νΈν™μ„±μ΄ μΆ‹μ
- **μ¥μ :** λ‹¨λ°©ν–¥ ν‘Έμ‹μ— λ§¤μ° μ ν•©, κ°€λ³κ³  μ•μ •μ 
- **λ‹¨μ :**μ¤μ§ μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ λ°©ν–¥λ§ κ°€λ¥ν•λ©°, ν…μ¤νΈ λ°μ΄ν„°λ§ μ „μ†΅ν•  μ μμ
- **μ‚¬μ© μ:** λ‰΄μ¤ ν”Όλ“, μ£Όμ‹ μ‹μ„Έ, μ•λ¦Ό μ¤νΈλ¦Ό

#### π“ WebSocket: "μ΄μ  μ°λ¦¬ κ³„μ† λ€ν™”ν•΄μ”." (μ‹¤μ‹κ°„ μ „ν™” ν†µν™”)
- **κ°λ…:** HTTP Handshake ν›„ TCP μ„μ—μ„ μ–‘λ°©ν–¥ μ‹¤μ‹κ°„ ν†µμ‹ 
- **νΉμ§•:** λ§¤μ° λ‚®μ€ μ§€μ—° μ‹κ°„, μµμ†ν•μ λ°μ΄ν„° μ „μ†΅λ‰, ν…μ¤νΈμ™€ λ°”μ΄λ„λ¦¬ λ¨λ‘ μ§€μ›ν•μ—¬ μ••λ„μ μΈ μ‹¤μ‹κ°„ μ„±λ¥μ„ λ³΄μ¥
- **μ¥μ :** μ €μ§€μ—°, μ§€μ† μ—°κ²°, μ–‘λ°©ν–¥ ν†µμ‹ , ν¨μ¨μ  λ€μ—­ν­ μ‚¬μ©
- **λ‹¨μ :** μƒνƒλ¥Ό μ μ§€(Stateful)ν•΄μ•Ό ν•λ―€λ΅ μ„λ²„ κµ¬ν„ λ° ν™•μ¥(Scale-out) μ „λµμ΄ λ³µμ΅
- **μ‚¬μ© μ:** μ±„ν…, μ£Όμ‹ κ±°λ, κ²μ„, IoT μ μ–΄, μ‹¤μ‹κ°„ λ€μ‹λ³΄λ“


### 3οΈβƒ£ μ¥μ κ³Ό λ‹¨μ  (Pros & Cons)

#### β… μ¥μ  (Benefits)
* **μ••λ„μ μΈ μ‹¤μ‹κ°„μ„±**: λ§¤μ° λ‚®μ€ μ§€μ—° μ‹κ°„(Low Latency)μΌλ΅ μ¦‰κ°μ μΈ λ°μ΄ν„° κµν™μ΄ κ°€λ¥ν•©
* **ν¨μ¨μ μΈ λ€μ—­ν­**: μµμ΄ μ—°κ²° ν›„μ—λ” μ‘μ€ ν¬κΈ°μ ν”„λ μ„λ§ κµν™ν•λ―€λ΅ HTTP ν—¤λ” μ¤λ²„ν—¤λ“κ°€ μ—†μ.
* **μ μ—°ν• λ°μ΄ν„° κµν™**: ν…μ¤νΈ(JSON λ“±)μ™€ λ°”μ΄λ„λ¦¬(μ΄λ―Έμ§€, μ¤λ””μ¤ λ“±) λ°μ΄ν„°λ¥Ό λ¨λ‘ μ§€μ›
* **μ–‘λ°©ν–¥ ν†µμ‹ **: ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ λ™λ“±ν• μ„μΉμ—μ„ λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›μ

#### β οΈ λ‹¨μ  (Challenges)
* **μƒνƒ μ μ§€(Stateful) κ΄€λ¦¬μ λ³µμ΅μ„±**: μ„λ²„κ°€ κ° ν΄λΌμ΄μ–ΈνΈμ μ—°κ²° μƒνƒλ¥Ό κ³„μ† κ΄€λ¦¬ν•΄μ•Ό ν•λ―€λ΅ λ©”λ¨λ¦¬ λ“± μ„λ²„ μμ› λ¶€λ‹΄
* **μ„λ²„ ν™•μ¥(Scale-out)μ μ–΄λ ¤μ›€**: μ—¬λ¬ μ„λ²„λ΅ ν™•μ¥ν•  λ• νΉμ • ν΄λΌμ΄μ–ΈνΈλ” **ν•­μƒ λ™μΌν• μ„λ²„μ— μ—°κ²°λλ„λ΅ λ³΄μ¥(Sticky Session)** ν•΄μ•Ό ν•λ” λ“± λ΅λ“ λ°Έλ°μ‹± μ „λµμ΄ λ³µμ΅
* **λ°©ν™”λ²½ λ° ν”„λ΅μ‹ νΈν™μ„±**: μΌλ¶€ μ¤λλ λ°©ν™”λ²½μ΄λ‚ ν”„λ΅μ‹ μ„λ²„λ” WebSocket ν”„λ΅ν† μ½μ„ μ΄ν•΄ν•μ§€ λ»ν•΄ μ—°κ²°μ„ μ°¨λ‹¨ν•  μ μμ
* **λ””λ²„κΉ…μ μ–΄λ ¤μ›€**: ν‘μ¤€ λΈλΌμ°μ € ν΄ μ™Έμ— νΈλν”½μ„ λ¶„μ„ν•κΈ°κ°€ HTTPλ³΄λ‹¤ κΉλ‹¤λ΅μ›€


---

### 4οΈβƒ£ μ‹¤λ¬΄ ν™μ© μ‚¬λ΅€

- **μ‹¤μ‹κ°„ μ±„ν… / ν‘μ—…**
- **μ£Όμ‹Β·μ•”νΈν™”ν νΈκ°€ μ¤νΈλ¦Ό**
- **λ©€ν‹°ν”λ μ΄μ–΄ κ²μ„ μƒνƒ λ™κΈ°ν™”**
- **IoT λ””λ°”μ΄μ¤ μ μ–΄**

---

### 5οΈβƒ£ λ©΄μ ‘ μμƒ μ§λ¬Έ (ν•µμ‹¬ λ‹µλ³€)

**Q1. Polling λ€μ‹  WebSocketμ„ μ‚¬μ©ν•λ” μ΄μ λ” λ¬΄μ—‡μΈκ°€μ”?**

> "κ°€μ¥ ν° μ΄μ λ” 'ν¨μ¨μ„±' λ•λ¬Έμ…λ‹λ‹¤. Pollingμ€ ν΄λΌμ΄μ–ΈνΈκ°€ κ³„μ† λ¶ν•„μ”ν• μ”μ²­μ„ λ³΄λ‚΄ μ„λ²„ μμ›μ„ λ‚­λΉ„ν•μ§€λ§, WebSocketμ€ ν•λ² μ—°κ²° ν›„ ν•„μ”ν• λ°μ΄ν„°λ§ μ£Όκ³ λ°›λ” μ§€μ†μ„± μ—°κ²° λ°©μ‹μ΄λΌ μ••λ„μ μΌλ΅ ν¨μ¨μ μ΄κ³  μ‹¤μ‹κ°„μ„±μ΄ λ†’μµλ‹λ‹¤."

**Q2. WebSocket Handshake κ³Όμ •μ„ μ„¤λ…**

> "κΈ°μ΅΄ HTTPλ¥Ό ν†µν•΄ μ—°κ²°μ„ μ‹μ‘ν•©λ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈκ°€ HTTP ν—¤λ”μ— **Upgrade: websocket**μ„ λ‹΄μ•„ μ”μ²­ν•λ©΄, μ„λ²„κ°€ μ΄λ¥Ό μλ½ν•κ³  **μƒνƒ μ½”λ“ 101 Switching Protocols**λ΅ μ‘λ‹µν•©λ‹λ‹¤. μ΄ν›„ ν†µμ‹  μ±„λ„μ΄ WebSocket ν”„λ΅ν† μ½λ΅ μ „ν™λμ–΄ μ–‘λ°©ν–¥ ν†µμ‹ μ΄ μ‹μ‘λ©λ‹λ‹¤."

**Q3. WebSocket μ„λ²„λ¥Ό μ—¬λ¬ λ€λ΅ ν™•μ¥(Scale-out)ν•  λ•μ κ³ λ ¤μ‚¬ν•­μ€ λ¬΄μ—‡μΈκ°€μ”?**

> "WebSocketμ€ **μƒνƒλ¥Ό μ μ§€(Stateful)**ν•λ―€λ΅ λ‹¨μ λ΅λ“λ°Έλ°μ‹±μ΄ μ–΄λ µμµλ‹λ‹¤. ν•΄κ²°μ±…μΌλ΅, νΉμ • μ‚¬μ©μλ¥Ό ν•­μƒ κ°™μ€ μ„λ²„λ΅ λ³΄λ‚΄λ” 'μ¤ν‹°ν‚¤ μ„Έμ…' λ°©μ‹μ΄λ‚, μ„λ²„ κ°„ λ©”μ‹μ§€λ¥Ό μ¤‘κ³„ν•΄μ£Όλ” 'Redis Pub/Sub' κ°™μ€ λ©”μ‹μ§€ λΈλ΅μ»¤λ¥Ό λ„μ…ν•μ—¬ μƒνƒλ¥Ό λ™κΈ°ν™”ν•λ” λ°©μ‹μ„ μ‚¬μ©ν•΄μ•Ό ν•©λ‹λ‹¤."

**Q4. WebSocketμ λ³΄μ•μ„ κ°•ν™”ν•λ” λ°©λ²•μ€ λ¬΄μ—‡μΈκ°€μ”?**

> "μ„Έ κ°€μ§€κ°€ ν•µμ‹¬μ…λ‹λ‹¤. μ²«μ§Έ, wss:// ν”„λ΅ν† μ½μ„ μ‚¬μ©ν•΄ ν†µμ‹ μ„ μ•”νΈν™”ν•©λ‹λ‹¤. λ‘μ§Έ, Handshake λ‹¨κ³„μ—μ„ Origin ν—¤λ”λ¥Ό κ²€μ¦ν•μ—¬ ν—κ°€λ μ¶μ²μ μ”μ²­λ§ μλ½ν•©λ‹λ‹¤. μ…‹μ§Έ, μ—°κ²° μ‹ JWT κ°™μ€ ν† ν°μΌλ΅ μ‚¬μ©μλ¥Ό μΈμ¦ν•μ—¬ μΈκ°€λ μ‚¬μ©μλ§ ν†µμ‹ ν•λ„λ΅ μ ν•ν•©λ‹λ‹¤."

---

### π― μµμΆ… μ”μ•½: μ–΄λ–¤ κΈ°μ μ„ μ„ νƒν•  κ²ƒμΈκ°€?

| κΈ°μ  | ν•µμ‹¬ νΉμ§• | μ΄λ΄ λ• μ‚¬μ©ν•μ„Έμ”! |
| :--- | :--- | :--- |
| **WebSocket** | β… μ–‘λ°©ν–¥, β… μ΄μ €μ§€μ—°, β… λ°”μ΄λ„λ¦¬ μ§€μ› | π’¬ **μ‹¤μ‹κ°„ μ±„ν…, λ©€ν‹°ν”λ μ΄μ–΄ κ²μ„, ν‘μ—… ν΄** |
| **SSE** | β… μ„λ²„β†’ν΄λΌμ΄μ–ΈνΈ λ‹¨λ°©ν–¥, β… μλ™ μ¬μ—°κ²°, β… HTTP μΉν™”μ  | π“° **λ‰΄μ¤ ν”Όλ“, μ£Όμ‹ μ‹μ„Έ, λ€μ‹λ³΄λ“ μ—…λ°μ΄νΈ** |
| **Long Polling** | β… μμ‚¬(Pseudo) ν‘Έμ‹, β… λ†’μ€ νΈν™μ„± | λ‚΅μ€ μ‹μ¤ν… ν™κ²½μ—μ„ μ‹¤μ‹κ°„ ν‰λ‚΄ λ‚Ό λ• |
| **Polling** | β… κ°€μ¥ λ‹¨μν•¨ | μ‹¤μ‹κ°„μ΄ μ „ν€ μ¤‘μ”ν•μ§€ μ•μ„ λ• |



